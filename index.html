<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>習慣化アプリ (タイマー・残り日数)</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }

        h1, h2 {
            color: #555;
            border-bottom: 2px solid #ccc;
            padding-bottom: 5px;
            margin-bottom: 20px;
        }

        div {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        label {
            display: inline-block;
            margin-bottom: 8px;
            font-weight: bold;
            margin-right: 10px;
        }

        /* 入力欄はタイマー表示に変わるので非表示にするかスタイルを変更 */
        /* input[type="number"],
        input[type="text"] {
            padding: 10px;
            margin-right: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1rem;
        } */

        /* タイマー表示エリアのスタイル */
        #timer-display {
            font-size: 2em; /* 大きめのフォントサイズ */
            font-weight: bold;
            margin: 10px 0; /* 上下の余白 */
            text-align: center; /* 中央揃え */
            color: #333;
        }

        /* ボタンコンテナのスタイル */
        #button-container {
            display: flex; /* ボタンを横並びにする */
            gap: 10px; /* ボタン間のスペース */
            margin-top: 15px; /* 上の要素との間に余白 */
            justify-content: center; /* ボタン全体を中央に配置 */
        }

        /* ボタンの基本スタイル */
        button {
            padding: 10px 20px;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
        }

        /* スタートボタンのスタイル */
        #start-button {
            background-color: #5cb85c; /* 緑 */
        }

        #start-button:hover:not(:disabled) {
            background-color: #4cae4c;
        }

        /* ストップボタンのスタイル */
        #stop-button {
            background-color: #d9534f; /* 赤 */
        }

        #stop-button:hover:not(:disabled) {
            background-color: #c9302c;
        }

         /* リセットボタンのスタイル (任意) */
        /* #reset-button {
            background-color: #f0ad4e; // オレンジ
        }

        #reset-button:hover:not(:disabled) {
            background-color: #ec971f;
        } */


        /* 無効化されたボタンのスタイル */
        button:disabled {
            background-color: #cccccc; /* グレー */
            cursor: not-allowed; /* カーソルを禁止マークに */
        }


        /* 記録表示エリア全体のスタイル */
        #record-area {
             /* div タグのスタイルが適用されます */
        }

        /* 個々の記録項目（JavaScriptで追加される予定の要素）のスタイル */
        .record-item {
            background-color: #e9e9e9;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 4px;
            border: 1px solid #ddd;
            word-break: break-all;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* 削除ボタンのスタイル */
        .delete-button {
            padding: 5px 10px;
            background-color: #d9534f;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 10px;
            flex-shrink: 0;
            transition: background-color 0.3s ease;
        }

        .delete-button:hover {
            background-color: #c9302c;
        }

        /* 残り日数表示エリアのスタイル */
        #countdown-display {
            font-size: 1.2em;
            text-align: center;
            margin-bottom: 20px;
            color: #007bff; /* 青色など、目立つ色に */
            font-weight: bold;
        }

        /* 関連リンクエリアのスタイル */
        #related-links {
            text-align: center; /* リンクを中央揃え */
            margin-top: 20px; /* 上の要素との間に余白 */
            font-size: 0.9em; /* 少し小さめのフォント */
        }

        #related-links a {
            color: #007bff; /* リンクの色 */
            text-decoration: none; /* 下線をなくす */
        }

        #related-links a:hover {
            text-decoration: underline; /* ホバー時に下線を表示 */
        }


        @media (max-width: 600px) {
            body {
                margin: 10px;
            }
            div {
                padding: 10px;
            }
            input[type="number"],
            input[type="text"],
            button {
                font-size: 0.9rem;
            }
            .delete-button {
                font-size: 0.7rem;
                padding: 3px 6px;
            }
            #timer-display {
                font-size: 1.5em; /* スマートフォンでは少し小さく */
            }
            #button-container {
                 flex-direction: column; /* スマートフォンではボタンを縦並びに */
                 align-items: center; /* 中央揃え */
            }
             #button-container button {
                 width: 80%; /* ボタンの幅を調整 */
             }
             #countdown-display {
                 font-size: 1em; /* スマートフォンでは少し小さく */
             }
             #related-links {
                 font-size: 0.8em; /* スマートフォンではさらに小さく */
             }
        }

    </style>
</head>
<body>

    <h1>資格勉強 習慣化アプリ</h1>

    <div id="countdown-display"></div>

    <div>
        <h2>タイマー計測</h2>
        <div id="timer-display">00:00:00</div>

        <div id="button-container">
             <button id="start-button">スタート</button>
             <button id="stop-button" disabled>ストップ</button>
        </div>

    </div>

    <div id="record-area">
        <h2>過去の記録</h2>
        <div id="records-list">
            </div>
    </div>

    <div id="related-links">
        <p>関連リンク:</p>
        <a href="https://www.fe-siken.com/fekakomon.php" target="_blank">基本情報技術者試験 過去問道場</a>
    </div>


    <script>
        // HTML要素への参照を取得
        const timerDisplay = document.getElementById('timer-display');
        const startButton = document.getElementById('start-button');
        const stopButton = document.getElementById('stop-button');
        const recordsList = document.getElementById('records-list');
        const countdownDisplay = document.getElementById('countdown-display'); // 残り日数表示エリアを取得

        // ローカルストレージにデータを保存する際のキー名
        const STORAGE_KEY = 'qualificationStudyRecordsTimer';

        // タイマー関連の変数
        let startTime = null;
        let timerInterval = null;
        let elapsedTime = 0;

        // 試験日を設定 (2025年7月26日)
        const examDate = new Date('2025-07-26T00:00:00'); // 日付オブジェクトとして設定

        // --- 関数定義 ---

        // 現在の日付をYYYY-MM-DD 形式で取得する関数 (変更なし)
        function getCurrentDate() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // ローカルストレージから記録データを読み込む関数 (変更なし)
        function loadRecords() {
            const recordsJson = localStorage.getItem(STORAGE_KEY);
            if (recordsJson) {
                return JSON.parse(recordsJson);
            }
            return [];
        }

        // 記録データをローカルストレージに保存する関数 (変更なし)
        function saveRecords(records) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(records));
        }

        // 指定されたインデックスの記録を削除する関数 (変更なし)
        function deleteRecord(indexToDelete) {
            const records = loadRecords();
            records.splice(indexToDelete, 1);
            saveRecords(records);
            renderRecords();
        }

        // 経過時間を HH:MM:SS 形式でフォーマットする関数 (変更なし)
        function formatTime(milliseconds) {
            const totalSeconds = Math.floor(milliseconds / 1000);
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;

            const pad = (num) => String(num).padStart(2, '0');

            return `${pad(hours)}:${pad(minutes)}:${pad(seconds)}`;
        }

        // タイマー表示を更新する関数 (変更なし)
        function updateTimerDisplay() {
            const now = Date.now();
            elapsedTime = now - startTime;
            timerDisplay.textContent = formatTime(elapsedTime);
        }

        // 記録リストを表示エリアに描画する関数 (変更なし)
        function renderRecords() {
            recordsList.innerHTML = '';
            const records = loadRecords();

            if (records.length === 0) {
                recordsList.innerHTML = '<div class="record-item">まだ記録がありません。</div>';
                return;
            }

            records.forEach((record, index) => {
                const recordItem = document.createElement('div');
                recordItem.classList.add('record-item');

                const recordContent = document.createElement('span');
                recordContent.textContent = `${record.date}: ${formatTime(record.time)}`;

                const deleteButton = document.createElement('button');
                deleteButton.textContent = '削除';
                deleteButton.classList.add('delete-button');

                deleteButton.addEventListener('click', () => {
                    if (confirm('この記録を削除してもよろしいですか？')) {
                         deleteRecord(index);
                    }
                });

                recordItem.appendChild(recordContent);
                recordItem.appendChild(deleteButton);
                recordsList.appendChild(recordItem);
            });
        }

        // 試験日までの残り日数を計算して表示する関数 (変更なし)
        function updateCountdown() {
            const today = new Date();
            // 時刻情報を取り除き、日付のみで比較するために日付をリセット
            today.setHours(0, 0, 0, 0);
            examDate.setHours(0, 0, 0, 0); // 試験日も日付のみにリセット

            const timeDiff = examDate.getTime() - today.getTime(); // ミリ秒単位での差
            const daysRemaining = Math.ceil(timeDiff / (1000 * 60 * 60 * 24)); // 日数に変換 (小数点以下を切り上げ)

            if (daysRemaining > 0) {
                countdownDisplay.textContent = `基本情報技術者試験まで あと ${daysRemaining} 日`;
            } else if (daysRemaining === 0) {
                 countdownDisplay.textContent = `基本情報技術者試験は本日です！`;
            }
            else {
                countdownDisplay.textContent = `基本情報技術者試験は終了しました。`;
            }
        }


        // --- イベントリスナー --- (変更なし)

        startButton.addEventListener('click', () => {
            startTime = Date.now();
            timerInterval = setInterval(updateTimerDisplay, 1000);

            startButton.disabled = true;
            stopButton.disabled = false;
        });

        stopButton.addEventListener('click', () => {
            clearInterval(timerInterval);

            const measuredTime = elapsedTime;

            if (measuredTime <= 0) {
                 alert('計測時間が短すぎます。');
                 elapsedTime = 0;
                 timerDisplay.textContent = formatTime(elapsedTime);
                 startButton.disabled = false;
                 stopButton.disabled = true;
                 return;
            }

            const today = getCurrentDate();

            const newRecord = {
                date: today,
                time: measuredTime,
            };

            const records = loadRecords();
            records.push(newRecord);
            saveRecords(records);

            elapsedTime = 0;
            timerDisplay.textContent = formatTime(elapsedTime);

            startButton.disabled = false;
            stopButton.disabled = true;

            renderRecords();
            alert('記録しました！');
        });


        // --- アプリの初期化 ---

        // ページが読み込まれたときに、ローカルストレージから記録を読み込んで表示する
        renderRecords();

        // ページ読み込み時に残り日数を計算して表示する
        updateCountdown();

        // 毎日残り日数を更新したい場合は、setIntervalなどで定期的にupdateCountdownを呼び出すことも可能ですが、
        // 通常はページを開いたときに計算し直せば十分です。
        // setInterval(updateCountdown, 1000 * 60 * 60 * 24); // 例: 24時間ごとに更新

    </script>

</body>
</html>
